{"ast":null,"code":"import socketIOClient from 'socket.io-client';\nimport { useState, useEffect, useRef } from 'react';\n\nconst useSocket = () => {\n  const [typingUsrs, setTypingUsrs] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [seenState, setSeen] = useState(true);\n  const [seenUsrs, setSeenUsrs] = useState([]);\n  const [users, setUsers] = useState([]);\n  const socketRef = useRef();\n  socketRef.current = socketIOClient('http://localhost:5000');\n  const usr = prompt('Tell us your name');\n  useEffect(() => {\n    // setUsr(prompt('Tell us your name'))\n    socketRef.current.emit('join', usr);\n    socketRef.current.on('init', usrs => {\n      setUsers(Object.values(usrs)); // console.log(`${usr} is typing`)\n    });\n    socketRef.current.on('typing', usr => {\n      setTypingUsrs(typingUsrs => [...typingUsrs, usr]); // console.log(`${usr} is typing`)\n    });\n    socketRef.current.on('message', msg => {\n      setMessages(messages => [...messages, msg]);\n      setSeen(false);\n    });\n    socketRef.current.on('seen', usr => {\n      setSeenUsrs(seenUsrs => [...seenUsrs, usr]); // console.log(`seen by ${usr}`)\n    });\n    return () => {\n      // socketRef.current.emit('leave', usr);\n      socketRef.current.disconnect();\n    };\n  }, []);\n\n  const typing = () => {\n    socketRef.current.emit('typing', usr);\n  };\n\n  const send = msg => {\n    socketRef.current.emit('message', msg, usr);\n  };\n\n  const seen = usr => {\n    !seenState && socketRef.current.emit('seen', usr) && setSeen(true);\n  };\n\n  return {\n    messages,\n    send,\n    typing,\n    seen\n  };\n};\n\nexport default useSocket;","map":{"version":3,"sources":["/home/salman/.local/share/dot_files/Storage/Workspace/soulfly/client/src/useSocket.js"],"names":["socketIOClient","useState","useEffect","useRef","useSocket","typingUsrs","setTypingUsrs","messages","setMessages","seenState","setSeen","seenUsrs","setSeenUsrs","users","setUsers","socketRef","current","usr","prompt","emit","on","usrs","Object","values","msg","disconnect","typing","send","seen"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,kBAA3B;AACA,SAASC,QAAT,EAAmBC,SAAnB,EAA8BC,MAA9B,QAA4C,OAA5C;;AAEA,MAAMC,SAAS,GAAG,MAAM;AACrB,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BL,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACM,QAAD,EAAWC,WAAX,IAA0BP,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACQ,SAAD,EAAYC,OAAZ,IAAuBT,QAAQ,CAAC,IAAD,CAArC;AACA,QAAM,CAACU,QAAD,EAAWC,WAAX,IAA0BX,QAAQ,CAAC,EAAD,CAAxC;AAEA,QAAM,CAACY,KAAD,EAAQC,QAAR,IAAoBb,QAAQ,CAAC,EAAD,CAAlC;AAEA,QAAMc,SAAS,GAAGZ,MAAM,EAAxB;AACAY,EAAAA,SAAS,CAACC,OAAV,GAAoBhB,cAAc,CAAC,uBAAD,CAAlC;AAEA,QAAMiB,GAAG,GAAGC,MAAM,CAAC,mBAAD,CAAlB;AAEAhB,EAAAA,SAAS,CAAC,MAAM;AAEb;AAGAa,IAAAA,SAAS,CAACC,OAAV,CAAkBG,IAAlB,CAAuB,MAAvB,EAA+BF,GAA/B;AAEAF,IAAAA,SAAS,CAACC,OAAV,CAAkBI,EAAlB,CAAqB,MAArB,EAA6BC,IAAI,IAAI;AAClCP,MAAAA,QAAQ,CAACQ,MAAM,CAACC,MAAP,CAAcF,IAAd,CAAD,CAAR,CADkC,CAElC;AACF,KAHD;AAKAN,IAAAA,SAAS,CAACC,OAAV,CAAkBI,EAAlB,CAAqB,QAArB,EAA+BH,GAAG,IAAI;AACnCX,MAAAA,aAAa,CAACD,UAAU,IAAI,CAAE,GAAGA,UAAL,EAAiBY,GAAjB,CAAf,CAAb,CADmC,CAEnC;AACF,KAHD;AAKAF,IAAAA,SAAS,CAACC,OAAV,CAAkBI,EAAlB,CAAqB,SAArB,EAAgCI,GAAG,IAAI;AACpChB,MAAAA,WAAW,CAACD,QAAQ,IAAI,CAAC,GAAGA,QAAJ,EAAciB,GAAd,CAAb,CAAX;AACAd,MAAAA,OAAO,CAAC,KAAD,CAAP;AACF,KAHD;AAKAK,IAAAA,SAAS,CAACC,OAAV,CAAkBI,EAAlB,CAAqB,MAArB,EAA6BH,GAAG,IAAI;AACjCL,MAAAA,WAAW,CAAED,QAAQ,IAAI,CAAE,GAAGA,QAAL,EAAeM,GAAf,CAAd,CAAX,CADiC,CAEjC;AACF,KAHD;AAKA,WAAO,MAAM;AACV;AACAF,MAAAA,SAAS,CAACC,OAAV,CAAkBS,UAAlB;AACF,KAHD;AAIF,GA/BQ,EA+BN,EA/BM,CAAT;;AAiCA,QAAMC,MAAM,GAAG,MAAM;AAClBX,IAAAA,SAAS,CAACC,OAAV,CAAkBG,IAAlB,CAAuB,QAAvB,EAAiCF,GAAjC;AACF,GAFD;;AAIA,QAAMU,IAAI,GAAGH,GAAG,IAAI;AACjBT,IAAAA,SAAS,CAACC,OAAV,CAAkBG,IAAlB,CAAuB,SAAvB,EAAkCK,GAAlC,EAAuCP,GAAvC;AACF,GAFD;;AAIA,QAAMW,IAAI,GAAGX,GAAG,IAAI;AACjB,KAACR,SAAD,IAAcM,SAAS,CAACC,OAAV,CAAkBG,IAAlB,CAAuB,MAAvB,EAA+BF,GAA/B,CAAd,IAAqDP,OAAO,CAAC,IAAD,CAA5D;AACF,GAFD;;AAIA,SAAO;AAAEH,IAAAA,QAAF;AAAYoB,IAAAA,IAAZ;AAAkBD,IAAAA,MAAlB;AAA0BE,IAAAA;AAA1B,GAAP;AAEF,CA5DD;;AA8DA,eAAexB,SAAf","sourcesContent":["import socketIOClient from 'socket.io-client';\nimport { useState, useEffect, useRef } from 'react';\n\nconst useSocket = () => {\n   const [typingUsrs, setTypingUsrs] = useState([]);\n   const [messages, setMessages] = useState([]);\n   const [seenState, setSeen] = useState(true);\n   const [seenUsrs, setSeenUsrs] = useState([]);\n\n   const [users, setUsers] = useState([]);\n\n   const socketRef = useRef();\n   socketRef.current = socketIOClient('http://localhost:5000');\n\n   const usr = prompt('Tell us your name')\n\n   useEffect(() => {\n\n      // setUsr(prompt('Tell us your name'))\n\n\n      socketRef.current.emit('join', usr);\n\n      socketRef.current.on('init', usrs => {\n         setUsers(Object.values(usrs))\n         // console.log(`${usr} is typing`)\n      })\n\n      socketRef.current.on('typing', usr => {\n         setTypingUsrs(typingUsrs => [ ...typingUsrs, usr ])\n         // console.log(`${usr} is typing`)\n      })\n\n      socketRef.current.on('message', msg => {\n         setMessages(messages => [...messages, msg ])\n         setSeen(false)\n      })\n\n      socketRef.current.on('seen', usr => {\n         setSeenUsrs( seenUsrs => [ ...seenUsrs, usr ] )\n         // console.log(`seen by ${usr}`)\n      })\n\n      return () => {\n         // socketRef.current.emit('leave', usr);\n         socketRef.current.disconnect();\n      };\n   }, []);\n\n   const typing = () => {\n      socketRef.current.emit('typing', usr);\n   };\n\n   const send = msg => {\n      socketRef.current.emit('message', msg, usr);\n   };\n\n   const seen = usr => {\n      !seenState && socketRef.current.emit('seen', usr) && setSeen(true)\n   };\n\n   return { messages, send, typing, seen };\n\n};\n\nexport default useSocket;\n"]},"metadata":{},"sourceType":"module"}